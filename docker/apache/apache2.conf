# Simple Apache configuration for Initiate D&D Tracker
# Uses default PHP Docker Apache modules

ServerRoot /etc/apache2
PidFile ${APACHE_PID_FILE}
DefaultRuntimeDir ${APACHE_RUN_DIR}

# Basic server settings
Timeout 300
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 5
User ${APACHE_RUN_USER}
Group ${APACHE_RUN_GROUP}

# Server identity
ServerTokens Prod
ServerSignature Off

# Logging
LogLevel warn
ErrorLog ${APACHE_LOG_DIR}/error.log
CustomLog ${APACHE_LOG_DIR}/access.log combined

# Include dynamic modules (built into Docker image)
IncludeOptional mods-enabled/*.load
IncludeOptional mods-enabled/*.conf

# Include ports and sites
Include ports.conf
IncludeOptional sites-enabled/*.conf

# Security headers
Header always set X-Frame-Options DENY
Header always set X-Content-Type-Options nosniff
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# Directory permissions
<Directory />
    Options FollowSymLinks
    AllowOverride None
    Require all denied
</Directory>

<Directory /var/www/>
    Options Indexes FollowSymLinks
    AllowOverride All
    Require all granted
</Directory>

# Hide sensitive files
<FilesMatch "\.(sql|log|ini|env)$">
    Require all denied
</FilesMatch>

# Directory index
DirectoryIndex index.php index.html

# MIME types
TypesConfig /etc/mime.types